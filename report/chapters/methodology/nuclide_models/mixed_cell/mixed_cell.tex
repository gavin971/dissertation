\subsection{Mixed Cell Volume Radionuclide Transport Model}\label{sec:mixed_cell}
Slightly more complex and suited to representing waste form and buffer 
components, the mixed cell model incorporates solubility limited, congruent 
release under the influence of elemental solubility limits, sorption, diffusive 
behavior, and advective behavior. Abstraction results concerning the 
transition between primarily diffusive and primarily advective transport regimes 
were used for benchmarking and to iteratively improve accuracy in the development 
of this model.

A main nuclide transport component model used in this work is a mixed cell 
component module incorporating solubility and sorption effects as well as  
engineered material dissolution.

A graphical representation of the mixed cell model is given in Figure 
\ref{fig:deg_sorb_volumes}.  
\input{./chapters/methodology/nuclide_models/mixed_cell/deg_sorb_volumes}

After some time degrading, the total volume in the degraded region can be 
expressed as in equation \eqref{deg_volumes}. Additionally, the intact and 
degraded volumes can also be describe by their constituent solid matrix and 
pore fluid volumes, 

\begin{align}
V_d(t_n) &= \mbox{ degraded volume at time }t_n [m^3]\nonumber\\
          &= V_{df}(t_n) + V_{ds}(t_n)
\intertext{where}
V_{df}(t_n) &= \mbox{ degraded solid volume at time }t_n[m^3]\nonumber\\
       &= \theta V_d(t_n)\\
       &= \theta d(t_n) V_T
\intertext{and}
d(t_n) &= \int_{t_0}^{t_n} f(\cdots)dt
\end{align}
\begin{align}
V_{ds}(t_n) &= \mbox{ degraded fluid volume at time }t_n [m^3]\nonumber\\
       &= (1-\theta) V_d(t_n)\\
       &= (1-\theta) d(t_n) V_T
\end{align}
\begin{align}
V_i(t_n) &= \mbox{ intact volume at time }t_n [m^3]\nonumber\\ 
       &= V_{if}(t_n) + V_{is}(t_n)
\end{align}
\begin{align}
V_{if}(t_n) &= \mbox{ intact fluid volume at time }t_n [m^3]\nonumber\\
       &= \theta V_i(t_n)\\
       &= \theta (1-d(t_n))V_T
\intertext{and}
V_{is}(t_n) &= \mbox{ intact solid volume at time }t_n [m^3]\nonumber\\
       &= (1-\theta) V_i(t_n)\\
       &= (1-\theta) (1-d(t_n))V_T.
\end{align}

This model distributes contaminant masses throughout the volume. Contaminant 
masses and concentrations can therefore be expressed with notation indicating 
in which volume they reside, such that

\begin{align}
C_{df} &= \frac{m_{df}}{V_{df}} \label{c_df}\\
C_{ds} &= \frac{m_{ds}}{V_{ds}} \label{c_ds}\\
C_{if} &= \frac{m_{if}}{V_{if}} \label{c_if}\\
C_{is} &= \frac{m_{is}}{V_{is}}.  \label{c_is}
\end{align}

The contaminant mass in the degraded fluid is the contaminant mass that is 
treated as 'released' or available to adjacent components. Mass contributions 
from adjacent cells are calculated at each time step and redistributed across 
the cell. This distribution of contaminant mass is restricted, however, by both 
solubility limitation and sorption.  

\subsubsection{Sorption}

The mass in both the free fluid and in the intact matrix exists in both 
sorbed and non-sorbed phases. The relationship between the sorbed mass 
concentration in the solid phase (e.g. the pore walls),

\begin{align}
s &=\frac{\mbox{ mass of sorbed contaminant} }{ \mbox{mass of total solid phase }}
\label{solid_conc}
\end{align}
and the dissolved liquid concentration, 
\begin{align}
c &=\frac{\mbox{ mass of dissolved contaminant} }{ \mbox{volume of total liquid phase }}
\label{liquid_conc}
\end{align}
can be characterized by a sorption `isotherm' model. A sorption isotherm 
describes the equilibrium relationship between the amount of material bound to 
surfaces and the amount of material in the solution. The MixedCell NuclideModel 
uses a linear isotherm model.

With the linear isotherm model, the mass of contaminant sorbed into the 
degraded and precipitated solids can be found 
\cite{schwartz_fundamentals_2004}, according to the relationship 
\begin{align}
s_{i} &= K_{di} c_{i}
\label{linear_iso}
\intertext{where}
s_i &= \mbox{ the solid concentration of isotope i }[kg/kg]\nonumber\\
K_{di} &= \mbox{ the distribution coefficient of isotope i}[m^3/kg]\nonumber\\
c_i &= \mbox{ the liquid concentration of isotope i }[kg/m^3].\nonumber
\end{align}

Thus, from \eqref{solid_conc},

\begin{align}
s_{dsi} &= K_{di} C_{dfi}\nonumber\\
         &= \frac{K_{di}m_{dfi}}{V_{df}}\nonumber
\intertext{where}
s_{dsi} &= \mbox{ isotope i concentration in degraded solids } [kg/kg] \nonumber\\
C_{dfi} &= \mbox{ isotope i concentration in degraded fluids } [kg/m^3]. \nonumber
\end{align}

In this model, sorption is taken into account throughout the volume. In the 
intact matrix, the contaminant mass is distributed between the pore walls and 
the pore fluid by sorption.  So too, contaminant mass released from the intact 
matrix by degradation is distributed between dissolved mass in the free fluid 
and sorbed mass in the degraded and precipitated solids.

To solve for the boundary conditions in this model, the amount of non-sorbed 
contaminant mass in the degraded fluid volume must be found. Dropping the 
isotope subscripts and beginning with equations \eqref{c_df} and \eqref{linear_iso},

\begin{align}
m_{df} &= \frac{C_{df}}{V_{df}} = \frac{m_{ds}V_{df}}{K_dV_{ds}}\nonumber
\intertext{and assuming the sorbate is in the degraded solids}
       &= \frac{V_{df}}{K_dV_{ds}}\left(dm_T - m_{df}\right)\nonumber
\intertext{this can be rearranged to give}
m_{df} &= \frac{dm_TV_{df}}{K_dV_{ds}}\frac{1}{\left( 1+ \frac{V_{df}}{K_dV_{ds}}\right)}.
\intertext{Finally, in terms of total volume,}
m_{df} &= \frac{d^2 m_T\theta V_T}{dK_d(1-\theta)V_T}\left( \frac{1}{1+\frac{\theta d V_T}{K_d(1-\theta)dV_T} }\right)\\  
       &= \frac{d m_T\theta }{K_d(1-\theta) + \theta}.
\end{align}

\subsubsection{Solubility}
In addition to engineered barriers, contaminant transport is constrained by the 
elemental solubility limit \cite{hedin_integrated_2002}, 
    \begin{align}
      m_i &\leq V_w C_{sol,i}
    \intertext{where}
      m_i &= \mbox{ solubility limited mass of isotope i in volume }V_w [kg]\nonumber\\ 
      V_w &= \mbox{ volume of the solution }[m^3]\nonumber\\
      C_{sol,i} &= \mbox{ solubility limit, the maximum concentration of i }[kg/m^3].\nonumber
    \end{align}


\subsubsection{Calculation of Mass Transfer}
The MixedCell model can operate in four modes, each dictating the method by 
which mass transfer across the inner boundary is calculated.  Those modes 
utilize the source term, Dirichlet, and Neumann interfaces to model prescribed, 
flow, advective flow, or diffusive flow.
Once calculated, that material object is removed from the 
internal component ($m_{ij} = -\dot{m}_i$) such that its internal state can be 
queried accurately in future timesteps.  

For the case in which source term is used on the inner boundary, the mass 
transferred from component $i$ to component $j$ in timestep $t_{n}$ is simply

\begin{align} 
m_{ij} &=  \matcal{S}_i(t_n) \nonumber
\intertext{where}
\mathcal{S}_i(t_n) &= \mbox{ source term provided by component i at }t_n [kg].
\end{align}

For the case in which Dirichlet is used, the mass transferred is determined by 
advection. One dimensional mass flux due to advection is the speed of flowing 
water, $v_z$, scaled by the concentration of contaminants fixed by the Dirichlet 
boundary condition, $C$, all integrated over the porous area perpendicular to 
the flow, $\theta dxdy$,

\begin{align}
  m_{ij} &= \int_{t_{n-1}}^{t_n}\int_0^y\int_0^x\theta v_z \mathcal{D}_i(t_n) dxdydt \label{mixed_adv}
\intertext{which, for the Cyder components, becomes }
m_{ij} &= \theta v_z C 2rl (t_n - t_{n-1})\nonumber\\
\intertext{where}
\mathcal{D}_i(t_n) &= \mbox{ fixed C from component i at }t_n [kg/m^3]\nonumber\\
r &= \mbox{ radius of the cylinder }[m]\nonumber\\
l &= \mbox{ length of the cylinder }[m].\nonumber
\end{align}

For the case in which Neumann is chosen, the mass transfer is purely diffusive. 

\begin{align}
  m_{ij} &= \int_{t_{n-1}}^{t_n}\int_0^y\int_0^x -D \mathcal{N}_i(t_n) dxdydt \label{mixed_adv}\\
  m_{ij} &= \int_{t_{n-1}}^{t_n}\int_0^y\int_0^x -D \frac{\partial C}{\partial z} dxdydt \nonumber
\intertext{which, for the Cyder components, becomes }
m_{ij} &= -D \frac{\partial C}{\partial z} 2rl(t_n - t_{n-1}\nonumber
\intertext{where}
\mathcal{N}_i(t_n) &= \mbox{ fixed concentration gradient from component i at }t_n [kg/m^3].\nonumber
\end{align}

\subsubsection{Boundary Conditions}
The desired boundary conditions can be expressed in terms of $m_{df}$. First, the 
Dirichlet boundary condition is 
\begin{align}
C(r, t_n) = \frac{m_{df}(t_n)}{V_{df}(t_n)}\forall (r) \in \Gamma.
\label{dirichlet_mixed}
\end{align}

From this boundary condition in combination with global advective velocity 
data, porosity data,  and elemental diffusion coefficient data, all other 
boundary conditions can be found. The Neumann boundary condition generated at 
the external boundary of cell $j$ relies on up to date data from cell $k$ and 
on internal state data from the previous time step, such that 

\begin{align}
-D\frac{dC}{dr}\Big|^{t_{n}}_{r=r_j} &= -D\frac{C_k(r_{k-1/2},t_{n-1}) - C_i(r_{j-1/2}, t_n)}{r_{k-1/2} - r_{j-1/2}}
\label{neumann_mixed}
\intertext{where}
r_{j-1/2} &= r_{j} - \frac{r_{j} - r_{0}}{2}.\nonumber\\
r_{k-1/2} &= r_{k} - \frac{r_{k} - r_{i}}{2}.\nonumber
\end{align}

This expression for the concentration gradient can also be used in the Cauchy 
boundary condition, which relies on the advective velocity and concentration 
profile as well as the concentration gradient,

\begin{align}
\theta_j C_j(t_n) &= \theta_j\frac{dC}{dr}\Big|_{r=r_{j}} + \theta_j v_{z}C_j.
\label{cauchy_mixed}
\end{align}

