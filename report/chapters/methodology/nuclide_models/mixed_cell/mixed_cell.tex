\subsection{Mixed Cell Volume Radionuclide Transport Model}\label{sec:mixed_cell}
Slightly more complex and suited to representing waste form and buffer 
components, the mixed cell model incorporates solubility limited, congruent 
release under the influence of elemental solubility limits, sorption, diffusive 
behavior, and advective behavior. Abstraction results concerning the 
transition between primarily diffusive and primarily advective transport regimes 
were used for benchmarking and to iteratively improve accuracy in the development 
of this model.

A main nuclide transport component model used in this work is a mixed cell 
component module incorporating solubility and sorption effects as well as  
engineered material dissolution.

A graphical representation of the mixed cell model is given in Figure 
\ref{fig:deg_sorb_volumes}.  
\input{./chapters/methodology/nuclide_models/mixed_cell/deg_sorb_volumes}

After some time degrading, the total volume in the degraded region can be 
expressed as in equation \eqref{deg_volumes}. Additionally, the intact and 
degraded volumes can also be describe by their constituent solid matrix and 
pore fluid volumes, 

\begin{align}
V_d &= \mbox{ degraded volume } [m^3]\nonumber\\
    &= V_{df} + V_{ds}
\intertext{where}
V_{df} &= \mbox{ degraded solid volume } [m^3]\nonumber\\
       &= \theta V_d\\
       &= \theta dV_T\\
V_{ds} &= \mbox{ degraded fluid volume } [m^3]\nonumber\\
       &= (1-\theta) V_d\\
       &= (1-\theta) dV_T\\
V_i &= \mbox{ intact volume } [m^3]\nonumber\\ 
       &= V_{if} + V_{is}\\
V_{if} &= \mbox{ intact fluid volume } [m^3]\nonumber\\
       &= \theta V_i\\
       &= \theta (1-d)V_T
\intertext{and}
V_{is} &= \mbox{ intact solid volume } [m^3]\nonumber\\
       &= (1-\theta) V_i\\
       &= (1-\theta) (1-d)V_T.
\end{align}

This model distributes contaminant masses throughout the volume. Contaminant 
masses and concentrations can therefore be expressed with notation indicating 
in which volume they reside, such that

\begin{align}
C_{df} &= \frac{m_{df}}{V_{df}} \label{c_df}\\
C_{ds} &= \frac{m_{ds}}{V_{ds}} \label{c_ds}\\
C_{if} &= \frac{m_{if}}{V_{if}} \label{c_if}\\
C_{is} &= \frac{m_{is}}{V_{is}}.  \label{c_is}
\end{align}

The contaminant mass in the degraded fluid is the contaminant mass that is 
treated as 'released' or available to adjacent components. Mass contributions 
from adjacent cells are calculated at each time step and redistributed across 
the cell. This distribution of contaminant mass is restricted, however, by both 
solubility limitation and sorption.  

\subsubsection{Sorption}

The mass in both the free fluid and in the intact matrix exists in both 
sorbed and non-sorbed phases. The relationship between the sorbed mass 
concentration in the solid phase (e.g. the pore walls),

\begin{align}
s &=\frac{\mbox{ mass of sorbed contaminant} }{ \mbox{mass of total solid phase }}
\label{solid_conc}
\end{align}
and the dissolved liquid concentration, 
\begin{align}
c &=\frac{\mbox{ mass of dissolved contaminant} }{ \mbox{volume of total liquid phase }}
\label{liquid_conc}
\end{align}
can be characterized by a sorption `isotherm' model. A sorption isotherm 
describes the equillibrium relationship between the amount of material bound to 
surfaces and the amount of material in the solution. The MixedCell NuclideModel 
uses a linear isotherm model.

With the lineadsisotherm model, the mass of contaminant sorbed into the 
degraded and precipitated solids can be found 
\cite{schwartz_fundamentals_2004}, according to the relationship 
\begin{align}
s_{i} &= K_{di} c_{i}
\label{linear_iso}
\intertext{where}
s_i &= \mbox{ the solid concentration of isotope i }[kg/kg]\nonumber\\
K_{di} &= \mbox{ the distribution coefficient of isotope i}[m^3/kg]\nonumber\\
c_i &= \mbox{ the liquid concentration of isotope i }[kg/m^3].\nonumber
\end{align}

Thus, from \eqref{solid_conc},

\begin{align}
s_{dsi} &= K_{di} C_{dfi}\nonumber\\
         &= \frac{K_{di}m_{dfi}}{V_{df}}\nonumber
\intertext{where}
s_{dsi} &= \mbox{ isotope i concentration in degraded solids } [kg/kg] \nonumber\\
C_{dfi} &= \mbox{ isotope i concentration in degraded fluids } [kg/m^3]. \nonumber
\end{align}

In this model, sorption is taken into account throughout the volume. In the 
intact matrix, the contaminant mass is distributed between the pore walls and 
the pore fluid by sorption.  So too, contaminant mass released from the intact 
matrix by degradation is distributed between dissolved mass in the free fluid 
and sorbed mass in the degraded and precipitated solids.

To solve for the boundary conditons in this model, the amount of non-sorbed 
contaminant mass in the degraded fluid volume must be found. Dropping the 
isotope subscritps and beginning with equations \eqref{c_df} and \eqref{linear_iso},

\begin{align}
m_{df} &= \frac{C_{df}}{V_{df}} = \frac{m_{ds}V_{df}}{K_dV_{ds}}\nonumber
\intertext{and assuming the sorbate is in the degraded solids}
       &= \frac{V_{df}}{K_dV_{ds}}\left(dm_T - m_{df}\right)\nonumber
\intertext{this can be rearranged to give}
m_{df} &= \frac{dm_TV_{df}}{K_dV_{ds}}\frac{1}{\left( 1+ \frac{V_{df}}{K_dV_{ds}}\right)}.
\intertext{Finally, in terms of total volume,}
m_{df} &= \frac{d^2 m_T\theta V_T}{dK_d(1-\theta)V_T}\left( \frac{1}{1+\frac{\theta d V_T}{K_d(1-\theta)dV_T} }\right)\\  
       &= \frac{d m_T\theta }{K_d(1-\theta) + \theta}.
\end{align}

\subsubsection{Solubility}
In addition to engineered barriers, contaminant transport is constrained by the 
elemental solubility limit \cite{hedin_integrated_2002}, 
    \begin{align}
      m_i &\leq V_w C_{sol,i}
    \intertext{where}
      m_i &= \mbox{ solubility limited mass of isotope i in volume }V_w [kg]\nonumber\\ 
      V_w &= \mbox{ volume of the solution }[m^3]\nonumber\\
      C_{sol,i} &= \mbox{ solubility limit, the maximum concentration of i }[kg/m^3].\nonumber
    \end{align}

\subsubsection{Boundary Conditions}
The desired boundary conditions can be expressed in terms of $m_{df}$. First, the 
Dirichlet boundary condition is 
\begin{align}
C^{n+1}(r) = \frac{m_{df}^{n+1}}{V_{df}^{n+1}}\forall (r) \in \Gamma.
\label{dirichlet_mixed}
\end{align}

From this boundary condition in combination with global advective velocity 
data, porosity data,  and elemental diffusion coefficient data, all other 
boundary conditions can be found. The Neumann boundary condition generated at 
the external boundary of cell $i$ relies on data from cell $j$ from the 
previous timestep, the cell external to it such that 

\begin{align}
-D\frac{dC}{dr}\big|^{n+1}_{r=r_{i}} &= \frac{C_j(r_{i+1/2}) - C_i(r_{i-1/2})}{r_{i+1/2} - 
r_{i-1/2}}
\label{neumann_mixed}
\intertext{where}
D &= \mbox{ diffusion coefficient }[]\nonumber\\
r_{i+1/2} &= r_{i} + \frac{r_{j} - r_{i}}{2}\nonumber\\
r_{i-1/2} &= r_{i} - \frac{r_{i} - r_{0}}{2}.\nonumber
\end{align}

This expression for the concentration gradient can also be used in the Cauchy 
boundary condition, which relies on the advective velocity and concentration 
profile as well as the concentration gradient,

\begin{align}
\theta_j C_j^n &= \theta_i\frac{dC}{dr}\big|_{r=r_{i}} + \theta_i v_{z}C_i.
\label{cauchy_mixed}
\end{align}

