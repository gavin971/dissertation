\subsection{One Dimensional Permeable Porous Medium Radionuclide Transport 
Model}\label{sec:one_dim_ppm}
Finally, abstraction results informed modifications to the implementation of an 
analytic solution to the one dimensional advection-dispersion equation with 
finite domain and Cauchy and Neumann boundary conditions at the inner and outer 
boundaries, respectively. 

Various solutions to the advection dispersion equation  
\eqref{unidirflow} have been published for both the first and third types of 
boundary conditions. The third, Cauchy type, is mass conservative, and will be 
the primary kind of boundary condition used at the source for this model.

The conceptual model in Figure \ref{fig:1dinf} represents solute transport in 
one dimension with unidirectional flow upward (a conservative assumption) and a 
semi-infinite boundary condition in the positive flow direction. The solution is 
given in van Genuchten et. al, \cite{van_genuchten_analytical_1981} and described below.  

\begin{figure}[h!]
  \begin{center}
    \def\svgwidth{.5\textwidth}
    \input{./chapters/methodology/nuclide_models/one_dim_ppm/1dinf.eps_tex}
  \end{center}
  \caption[1D semi-infinite advection dispersion solution.]{A one dimensional, 
  semi-infinite, unidirectional flow solution with Cauchy and Neumann boundary 
conditions}
  \label{fig:1dinf}
\end{figure}

For the boundary conditions, 
\begin{align}
  -D \frac{\partial C}{\partial z}\big|_{z=0} + v_zc &= \begin{cases}
    v_zC_0  &  \left( 0<t<t_0 \right)\\
    0  &  \left( t>t_0 \right)\\
  \end{cases}
\intertext{and}
  \frac{\partial C}{\partial z}\big|_{z=r} &= 0
  \intertext{and the initial condition,}
  C(z,0) &= C_i,
  \label{1dinfBC}
  \intertext{the solution is given as }
  C(z,t) &= \begin{cases} 
  C_i + \left(C_0 - C_i\right)A\left(z,t\right) & 0<t\le t_0\\
  C_i + \left(C_0 - C_i\right)A\left(z,t\right) - C_0A(z,t-t_0) & t\ge t_0.
  \end{cases}
\end{align}

For the vertical flow coordinate system, $A$ is defined as
\begin{align}
A(z,t) =& \left(\frac{1}{2}\right)\erfc{\left[\frac{Rz-vt}{2\sqrt{DRt}}\right]} \nonumber\\
&+ \left(\frac{v^2t}{\pi RD}\right)^{1/2}\exp{\left[-\frac{(Rz-vt)^2}{4DRt}\right]}\nonumber\\ 
&- \frac{1}{2} \left(1+\frac{vz}{D} + \frac{v^2t}{DR}\right) \exp{\left[\frac{vz}{D}\right]}\erfc{\left[\frac{Rz+vt}{2\sqrt{DRt}}\right]}\\
&+ \left(\frac{4v^2t}{\pi RD}\right)^{1/2}\left[1+\frac{v}{4d}\left(2L-z+\frac{vt}{R}\right)\right]\exp{\left[\frac{vL}{D} - \frac{R}{4Dt}\left(2L-z+\frac{vt}{R}\right)^2\right]}\nonumber\\
&- \frac{v}{D}\left[2L - z + \frac{3vt}{2R} + \frac{v}{4D}\left(2L - z + \frac{vt}{R}\right)^2\right]\exp{\frac{vL}{D}}\erfc{\left[\frac{R(2L-z) + vt}{2\sqrt{DRt}}\right]}\nonumber
\intertext{where}
R =& \mbox{Retardation factor }[-].\nonumber
\end{align}

In Cyclus, radioactive decay is handled external to the components, so $\mu$, 
the constant of decay, goes to zero. Similarly, 
take the zero order source term, $\gamma$ is taken to be zero, as no source term should emerge 
without decay or external injection. Importantly, when $\mu\rightarrow 0$ then 
$u\rightarrow v$. Simplifying $C(z,t)$ gives

\begin{align}
C(z,t) =& \begin{cases} 
  C_0A(z,t) + B(z,t) & 0<t\le t_0\\
  C_0A(z,t) + B(z,t) - C_0A(z,t-t_0)& t\ge t_0
  \end{cases}
  \label{simple_genuchten}
  \end{align}
and simplifying $A(z,t)$ gives 
\begin{align}
A(z,t) =& 
\left(\frac{1}{2}\right)\erfc{\left[\frac{Rz-vt}{2\sqrt{DRt}}\right]} \nonumber\\
&+ \left(v\infty\right)\exp{\left[\frac{2vz}{2D}\right]}\erfc{ \left[\frac{Rz+vt}{2\sqrt{DRt}}\right]}
\intertext{which remains valid at long distances and times, when }
\left[\frac{Rz+vt}{2\sqrt{DRt}}\right] >> 2
\intertext{such that}
A(z,t) =& 
\left(\frac{1}{2}\right)\erfc{\left[\frac{Rz-vt}{2\sqrt{DRt}}\right]} \\
\end{align}
Finally, simplifying $B(z,t)$ accordingly,
\begin{align}
B(z,t) =& 
\left(- C_i\right)\Bigg\{ \frac{1}{2}\erfc{\left[\frac{Rz - vt}{2\sqrt{DRt}}\right]}\nonumber\\
&+ \left(\frac{v^2t}{\pi RD}\right)^{1/2}\exp{\left[-\frac{(Rz-vt)^2}{4DRt}\right]}\Bigg\}.
  \label{simple_genuchten}
\end{align}


\subsubsection{Calculating Mass Transfer}
The mass transfer rate relies on an algorithm similar to that of the 
LumpedNuclide model. However, the integral, by virtue of not having a closed 
form solution, must be evaluated numerically. 

A numerical integration library within the Boost suite of C++ libraries is used 
to evaluate the integral of $C(t_n, r)$ in equation \eqref{simple_genuchten} 
by plugging it into equation \eqref{lp_mass}.


\subsubsection{Boundary Interfaces}
The external boundary conditions are found exactly similarly to the method by 
which the Degradation Rate model finds external boundary conditions in Section 
\ref{sec:dr_bc}. This method is entirely based on contained mass and component 
volume.  
