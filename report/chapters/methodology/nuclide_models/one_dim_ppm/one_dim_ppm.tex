\subsection{One Dimensional Permeable Porous Medium Radionuclide Transport 
Model}\label{sec:one_dim_ppm}
Finally, abstraction results informed modifications to the implementation of an 
analytic solution to the one dimensional advection-dispersion equation with 
finite domain and Cauchy and Neumann boundary conditions at the inner and outer 
boundaries, respectively. 

Various solutions to the advection dispersion equation  
\eqref{unidirflow} have been published for both the first and third types of 
boundary conditions. The third, Cauchy type, is mass conservative, and will be 
the primary kind of boundary condition used at the source for this model.

The conceptual model in Figure \ref{fig:1dinf} represents solute transport in 
one dimension with unidirectional flow upward (a conservative assumption) and a 
semi-infinite boundary condition in the positive flow direction. The solution is 
given (Leij et. al, \cite{leij_analytical_1991}) and described below.  

\begin{figure}[h!]
  \begin{center}
    \def\svgwidth{.5\textwidth}
    \input{./chapters/methodology/nuclide_models/one_dim_ppm/1dinf.eps_tex}
  \end{center}
  \caption[1D semi-infinite advection dispersion solution.]{A one dimensional, 
  semi-infinite, unidirectional flow solution with Cauchy and Neumann boundary 
conditions}
  \label{fig:1dinf}
\end{figure}

For the boundary conditions, 
\begin{align}
  -D \frac{\partial C}{\partial z}\big|_{z=0} + v_zc &= \begin{cases}
    v_zC_0  &  \left( 0<t<t_0 \right)\\
    0  &  \left( t>t_0 \right)\\
  \end{cases},\\
  \frac{\partial C}{\partial z}\big|_{z=\infty} &= 0
  \intertext{and the initial condition,}
  C(z,0) &= C_i,
  \label{1dinfBC}
  \intertext{the solution is given as }
  C(z,t) &= \begin{cases} 
  \left(C_0 - \frac{\gamma}{\mu}\right)A(z,t) + B(z,t) & 0<t\le t_0\\
  \left(C_0 - \frac{\gamma}{\mu}\right)A(z,t) + B(z,t) - C_0A(z,t-t_0)& t\ge t_0
  \end{cases}
\intertext{where}
  \gamma &= \mbox{ zero order source term in the fluid }[kg/m^3]\nonumber\\
  \mu &= \mbox{first order general decay constant }[s^{-1}].\nonumber
\end{align}


For the vertical flow coordinate system, $A$ and $B$ are defined as
\begin{align}
A(z,t) =& 
\left(\frac{v}{v+u}\right)\exp{\left[\frac{(v-u)z}{2D}\right]}\erfc{\left[\frac{Rz-ut}{2\sqrt{DRt}}\right]} \nonumber\\
&+ \left(\frac{v}{v-u}\right)\exp{\left[\frac{(v+u)z}{2D}\right]}\erfc{\left[\frac{Rz+ut}{2\sqrt{DRt}}\right]} \nonumber\\ 
&+ \left(\frac{v^2}{2\mu D}\right) \exp{\left[\frac{vz}{D} - \frac{\mu t}{R}\right]}\erfc{\left[\frac{Rz+vt}{2\sqrt{DRt}}\right]}\\
B(z,t) =& 
\left(\frac{\gamma}{\mu} - C_i\right)\Bigg\{ \frac{1}{2}\erfc{\left[\frac{Rz - vt}{2\sqrt{DRt}}\right]}\nonumber\\
&+ \left(\frac{v^2t}{\pi RD}\right)^{1/2}\exp{\left[-\frac{(Rz-vt)^2}{4DRt}\right]}\nonumber\\ 
&- \frac{1}{2} \left(1+\frac{vz}{D} + \frac{v^2t}{DR}\right) \exp{\left[\frac{vz}{D}\right]}\erfc{\left[\frac{Rz+vt}{2\sqrt{DRt}}\right]}\Bigg\}\\
\intertext{where}
u =& v\sqrt{\left(1+\frac{4\mu D}{v^2}\right)}\nonumber\\
R =& \mbox{Retardation factor }[-].\nonumber
\end{align}

We make the simplification that, in Cyclus, radioactive decay is handled external 
to the components, so $\mu$, the constant of decay goes to zero. Similarly, we 
take the zero order source term, $\gamma$ to be zero, as no source term should emerge 
without decay or external injection. Importantly, when $\mu\rightarrow 0$ then 
$u\rightarrow v$. Simplifying $C(z,t)$ gives,

\begin{align}
C(z,t) =& \begin{cases} 
  C_0A(z,t) + B(z,t) & 0<t\le t_0\\
  C_0A(z,t) + B(z,t) - C_0A(z,t-t_0)& t\ge t_0
  \end{cases}
  \end{align}
Simplifying $A(z,t)$, 
\begin{align}
A(z,t) =& 
\left(\frac{1}{2}\right)\erfc{\left[\frac{Rz-ut}{2\sqrt{DRt}}\right]} \nonumber\\
&+ \left(v\infty\right)\exp{\left[\frac{2vz}{2D}\right]}
\intertext{which remains valid only if }
\left[\frac{Rz+ut}{2\sqrt{DRt}}\right] \ge 2,
\end{align}
Finally, simplifying $B(z,t)$ accordingly,
\begin{align}
B(z,t) =& 
\left(- C_i\right)\Bigg\{ \frac{1}{2}\erfc{\left[\frac{Rz - vt}{2\sqrt{DRt}}\right]}\nonumber\\
&+ \left(\frac{v^2t}{\pi RD}\right)^{1/2}\exp{\left[-\frac{(Rz-vt)^2}{4DRt}\right]}\nonumber\\ 
&- \frac{1}{2} \left(1+\frac{vz}{D} + \frac{v^2t}{DR}\right) \exp{\left[\frac{vz}{D}\right]}\erfc{\left[\frac{Rz+vt}{2\sqrt{DRt}}\right]}\Bigg\}.
  \label{simple_genuchten}
\end{align}


\subsubsection{Calculating Mass Transfer}
The mass transfer rate relies on an algorithm similar to that of the 
LumpedNuclide model. However, the integral, by virtue of not having a closed 
form solution, must be evaluated numerically. 

\subsubsection{Boundary Conditions}
Again, the boundary conditions for the external boundary are found based on the 
mass contained in the cell by te same process as in the Degradation Rate model.
See equations \ldots 

